var ERE=ERE||{};!function(e){"use strict";var a=ere_main_vars.ajax_url,t=ere_main_vars.confirm_yes_text,r=ere_main_vars.confirm_no_text,n=ere_main_vars.loading_text,i=ere_main_vars.sending_text,o=ere_main_vars.decimals,s=ere_main_vars.dec_point,l=ere_main_vars.thousands_sep;ERE={init:function(){this.register_pattern_validator(),this.view_gallery(),this.favorite(),this.tooltip(),this.property_paging(),this.move_link_to_carousel(),this.execute_nav(),this.execute_slider_nav();var a=e(".pagination-image.ere-property-slider");this.sync_property_carousel(a),this.light_gallery()},register_pattern_validator:function(){e.validator.addMethod("pattern",function(e,a,t){return!!this.optional(a)||("string"==typeof t&&(t=new RegExp("^(?:"+t+")$")),t.test(e))},"Invalid format.")},number_format:function(e,a){a=void 0!==a?a:o,e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var t,r,n,i=isFinite(+e)?+e:0,d=isFinite(+a)?Math.abs(a):0,c=void 0===l?",":l,p=void 0===s?".":s,h="";return(h=(d?(t=i,r=d,n=Math.pow(10,r),""+Math.round(t*n)/n):""+Math.round(i)).split("."))[0].length>3&&(h[0]=h[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,c)),(h[1]||"").length<d&&(h[1]=h[1]||"",h[1]+=new Array(d-h[1].length+1).join("0")),h.join(p)},tooltip:function(){e('[data-toggle="tooltip"]').tooltip()},login_modal:function(){e("#ere_signin_modal").modal("show")},get_page_number_from_href:function(e){var a="",t=/paged=\d+/gi;return new RegExp(t).test(e)?a=new RegExp(t).exec(e):(t=/page\/\d+/gi,a=new RegExp(t).test(e)?new RegExp(t).exec(e):a),t=/\d+/g,new RegExp(t).test(a)?new RegExp(t).exec(a)[0]:1},view_gallery:function(){e(".property-view-gallery").on("click",function(t){t.preventDefault();var r=e(this),n=r.attr("data-property-id"),i=r.parent();r.parent().hasClass("on-handle")||(r.parent().addClass("on-handle"),e.ajax({type:"post",url:a,dataType:"json",data:{action:"ere_view_gallery_ajax",property_id:n},beforeSend:function(){r.children("i").addClass("fa-spinner fa-spin")},success:function(a){i.html(a),i.lightGallery({thumbnail:!1}),e(".btn-view-gallery-"+n).trigger("click")},error:function(){r.children("i").removeClass("fa-spinner fa-spin"),r.parent().removeClass("on-handle")}}))})},favorite:function(){e(".property-favorite").on("click",function(t){if(t.preventDefault(),!e(this).hasClass("on-handle")){var r=e(this).addClass("on-handle"),n=r.closest(".property-inner").addClass("property-active-hover"),i=r.attr("data-property-id"),o=r.attr("data-title-not-favorite"),s=r.attr("data-icon-not-favorite"),l=r.attr("data-title-favorited"),d=r.attr("data-icon-favorited");e.ajax({type:"post",url:a,dataType:"json",data:{action:"ere_favorite_ajax",property_id:i},beforeSend:function(){r.children("i").addClass("fa-spinner fa-spin")},success:function(e){void 0!==e.added&&-1!=e.added||ERE.login_modal(),1==e.added?(r.children("i").removeClass(s).addClass(d),r.attr("title",l)):0==e.added&&(r.children("i").removeClass(d).addClass(s),r.attr("title",o)),r.children("i").removeClass("fa-spinner fa-spin"),r.removeClass("on-handle"),n.removeClass("property-active-hover")},error:function(){r.children("i").removeClass("fa-spinner fa-spin"),r.removeClass("on-handle"),n.removeClass("property-active-hover")}})}})},light_gallery:function(){e("[data-rel='ere_light_gallery']").each(function(){var a=e(this),t=a.data("gallery-id");a.on("click",function(r){r.preventDefault();var n=[],i=0,o=e(this).attr("href"),s=e(this).data("thumb-src");void 0!==t&&(e('[data-gallery-id="'+t+'"]').each(function(a){var t=e(this).attr("href"),r=e(this).data("thumb-src"),l=e(this).attr("title");t==o&&r==s&&(i=a),void 0===l&&(l=""),n.push({src:t,downloadUrl:t,thumb:r,subHtml:l})}),a.lightGallery({hash:!1,galleryId:t,dynamic:!0,dynamicEl:n,thumbWidth:80,index:i}))})}),e("a.ere-view-video").on("click",function(a){a.preventDefault();var t=e(this).attr("data-src");e(this).lightGallery({dynamic:!0,dynamicEl:[{src:t,thumb:"",subHtml:""}]})})},show_loading:function(a){"undefined"!=a&&""!=a&&null!=a||(a=n);var t=wp.template("ere-processing-template");e("body").append(t({ico:"fa fa-spinner fa-spin",text:a}))},change_loading_status:function(a,t){e("i",".ere-processing").removeClass("fa-spinner fa-spin").addClass(a),e("span",".ere-processing").text(t)},close_loading:function(a){void 0!==a&&null!=a||(a=500),0==a?e(".ere-processing").remove():setTimeout(function(){e(".ere-processing").fadeOut(function(){e(".ere-processing").remove()})},a)},popup_alert:function(a,t,r){var n=wp.template("ere-dialog-template");e("body").append(n({ico:a,message:r})),e("#ere-dialog-popup").dialog({title:t,resizable:!1,closeOnEscape:!0,modal:!0,buttons:{Ok:function(){e(this).dialog("close"),e(this).dialog("destroy").remove()}}})},confirm_dialog:function(a,n,i,o){var s=wp.template("ere-dialog-template");e("body").append(s({ico:"fa fa-question-circle",message:n})),e("#ere-dialog-popup").dialog({title:a,resizable:!1,closeOnEscape:!0,modal:!0,buttons:[{text:t,click:function(){i&&i(),e(this).dialog("destroy").remove()}},{text:r,click:function(){o&&o(),e(this).dialog("close"),e(this).dialog("destroy").remove()}}]})},set_item_effect:function(a,t){if("hide"==t&&(a.css("transition","opacity 1.5s linear, transform 1s"),a.css("-webkit-transition","opacity 1.5s linear, transform 1s"),a.css("-moz-transition","opacity 1.5s linear, transform 1s"),a.css("-ms-transition","opacity 1.5s linear, transform 1s"),a.css("-o-transition","opacity 1.5s linear, transform 1s"),a.css("opacity",0),a.css("transform","scale(0.2)"),a.css("-ms-transform","scale(0.2)"),a.css("-webkit-transform","scale(0.2)")),"show"==t)for(var r=0;r<a.length;r++)!function(t){setTimeout(function(){e(a[t]).css("opacity",1),e(a[t]).css("transform","scale(1)"),e(a[t]).css("-ms-transform","scale(1)"),e(a[t]).css("-webkit-transform","scale(1)")},10*r)}(r)},select_term:function(){var a=e("select.property-filter-mb");a.off(),e(a).on("change",function(a){var t=e(this);t.attr("disabled","disabled"),a.preventDefault();var r=e("option:selected",t).attr("value");t.parent().prev().children('[data-filter="'+r+'"]').click()})},contact_agent_by_email:function(){e(".agent-contact-btn","#contact-agent-form").each(function(){e(this).on("click",function(t){t.preventDefault();e(this);var r=e(this).parents("form"),n=e('[name="sender_name"]',r).val(),o=e('[name="sender_phone"]',r).val(),s=e('[name="sender_email"]',r).val(),l=e('[name="sender_msg"]',r).val(),d=!1;null==n||0===n.length?(e(".name-error",r).removeClass("hidden"),d=!0):e(".name-error",r).hasClass("hidden")||e(".name-error",r).addClass("hidden"),null==o||0===o.length?(e(".phone-error",r).removeClass("hidden"),d=!0):e(".phone-error",r).hasClass("hidden")||e(".phone-error",r).addClass("hidden");var c=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;null!=s&&0!==s.length&&c.test(s)?e(".email-error",r).hasClass("hidden")||e(".email-error",r).addClass("hidden"):(e(".email-error",r).removeClass("hidden"),0===s.trim().length||c.test(s)?e(".email-error",r).text(e(".email-error",r).data("error")):e(".email-error",r).text(e(".email-error",r).data("not-valid")),d=!0),null==l||0===l.length?(e(".message-error",r).removeClass("hidden"),d=!0):e(".message-error",r).hasClass("hidden")||e(".message-error",r).addClass("hidden"),d||e.ajax({type:"post",url:a,dataType:"json",data:r.serialize(),beforeSend:function(){e(".form-messages",r).html('<span class="success text-success"> '+i+"</span>")},success:function(a){a.success?e(".form-messages",r).html('<span class="success text-success"><i class="fa fa-check"></i> '+a.message+"</span>"):("function"==typeof ere_reset_recaptcha&&ere_reset_recaptcha(),e(".form-messages",r).html('<span class="error text-danger"><i class="fa fa-close"></i> '+a.message+"</span>"))},error:function(){}})})})},property_paging:function(){var a=!0;e(".paging-navigation",".property-paging-wrap").each(function(){e("a",e(this)).off("click").on("click",function(t){if(t.preventDefault(),a){a=!1;var r=e(this),n=r.attr("href"),i=ERE.get_page_number_from_href(n),o=r.closest(".property-paging-wrap"),s=r.closest(".ere-property").find(".property-content");e.ajax({url:o.data("admin-url"),data:{action:"ere_property_paging_ajax",layout:o.data("layout"),items_amount:o.data("items-amount"),columns:o.data("columns"),image_size:o.data("image-size"),columns_gap:o.data("columns-gap"),view_all_link:o.data("view-all-link"),paged:i,property_type:o.data("property-type"),property_status:o.data("property-status"),property_feature:o.data("property-feature"),property_city:o.data("property-city"),property_state:o.data("property-state"),property_neighborhood:o.data("property-neighborhood"),property_label:o.data("property-label"),property_featured:o.data("property-featured"),author_id:o.data("author-id"),agent_id:o.data("agent-id")},success:function(t){var r=e(".property-item",t),n=e(".property-paging-wrap",t);s.css("opacity",0),s.html(r),ERE.set_item_effect(r,"hide");var i=s.offset().top-30;e("html,body").animate({scrollTop:+i+"px"},500),s.css("opacity",1),s.imagesLoaded(function(){r=e(".property-item",s),ERE.set_item_effect(r,"show"),s.closest(".ere-property").find(".property-paging-wrap").html(n.html()),ERE.property_paging(),ERE.property_paging_control(),ERE.favorite(),ERE.tooltip(),ERE_Compare.register_event_compare()}),a=!0},error:function(){a=!0}})}})})},property_paging_control:function(){e(".paging-navigation",".ere-property").each(function(){var a=e(this);0===a.find("a.next").length?a.addClass("next-disable"):a.removeClass("next-disable")})},move_link_to_carousel:function(){e(".property-carousel").each(function(){var a=e(this);e(".owl-carousel",a).on("owlInitialized",function(){if(void 0!=a.data("view-all-link")&&(a.children(".owl-loaded").hasClass("owl-nav-top-right")||a.children(".owl-loaded").hasClass("owl-nav-bottom-center"))){var e=a.find(".view-all-link");e.length>0&&!a.find(".owl-nav").hasClass("disabled")&&(e.removeClass("mg-top-60 sm-mg-top-40"),a.find(".owl-nav").addClass("has-view-all"),a.find(".owl-nav").append(e[0].outerHTML),e.remove())}a.hasClass("owl-move-nav-par-with-heading")&&a.find(".ere-heading").length>0&&!a.find(".ere-heading").hasClass("heading-contain-owl-nav")&&(a.find(".ere-heading").addClass("heading-contain-owl-nav"),a.find(".owl-nav").addClass("owl-nav-top-right").insertAfter(a.find(".ere-heading").children("h2")))})})},execute_nav:function(){e(".ere-property-carousel").each(function(){var a=e(this),t=e(".navigation-wrap",a),r=e(".owl-carousel .property-item",a);ERE.ere_calc_column_padding(t,r),e(".owl-carousel",a).on("owlInitialized",function(){var a=e(this),r=e(".owl-nav",a);t.length>0&&r.length>0&&r.detach().appendTo(t),ERE.ere_calc_column_padding(t,e(".property-item",a))})})},ere_calc_column_padding:function(e,a){if(e.height()<a.height()){var t=Math.floor((a.height()-e.height())/2);e.css({"padding-top":t+"px","padding-bottom":t+"px"})}},execute_slider_nav:function(){e(".ere-property-slider.navigation-middle").each(function(){ERE.ere_calc_nav_top(e(".owl-carousel",e(this))),e(".owl-carousel",e(this)).on("owlInitialized",function(){var a=e(this);e(".owl-nav",a).addClass("container"),setTimeout(function(){ERE.ere_calc_nav_top(a)},20)})})},ere_calc_nav_top:function(a){var t=e(".owl-nav",a),r=e(".property-item",a).outerHeight(),n=e(".block-center-inner",a).outerHeight(),i=Math.floor((r-n)/2);t.css("top",i+"px")},sync_property_carousel:function(a){var t=e("body").hasClass("rtl"),r=a.find(".property-content-slider"),n=a.find(".property-image-slider");r.owlCarousel({items:1,autoHeight:!0,nav:!1,dots:!1,loop:!1,smartSpeed:500,rtl:t}).on("changed.owl.carousel",function(e){var a=e.item.index;n.find(".owl-item").removeClass("current").eq(a).addClass("current");var t=n.find(".owl-item.active").length-1,r=n.find(".owl-item.active").first().index(),i=n.find(".owl-item.active").last().index();a>i&&n.data("owl.carousel").to(a,500,!0);a<r&&n.data("owl.carousel").to(a-t,500,!0)}),n.on("initialized.owl.carousel",function(){n.find(".owl-item").eq(0).addClass("current")}).owlCarousel({nav:!1,dots:!1,rtl:t,margin:10,responsive:{992:{items:4},768:{items:3},480:{items:2},0:{items:1}}}).on("changed.owl.carousel",function(e){var a=e.item.index;r.data("owl.carousel").to(a,500,!0)}),n.on("click",".owl-item",function(a){if(a.preventDefault(),!e(this).hasClass("current")){var t=e(this).index();r.data("owl.carousel").to(t,500,!0)}})}},e(document).ready(function(){ERE.init()}),e(window).resize(function(){setTimeout(ERE.execute_nav,20),setTimeout(function(){ERE.execute_slider_nav();var a=e(".pagination-image.ere-property-slider");ERE.sync_property_carousel(a)},10)})}(jQuery);